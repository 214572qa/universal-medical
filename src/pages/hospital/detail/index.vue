<template>
    <div class="detail">
        <!-- 骨架屏 -->
        <el-skeleton :loading="loading" animated :rows="10">
            <template #default>
                <!-- 医院名字于医院点击的结构 -->
                <div class="top">
                    <div class="name">{{ hospitalStore.hospitalInfo.hospital?.hosname }}</div>
                    <div class="level">
                        <svg t="1768384655497" class="icon" viewBox="0 0 1024 1024" version="1.1"
                            xmlns="http://www.w3.org/2000/svg" p-id="3228" width="16" height="16">
                            <path
                                d="M190.193225 471.411583c14.446014 0 26.139334-11.718903 26.139334-26.13831 0-14.44499-11.69332-26.164916-26.139334-26.164916-0.271176 0-0.490164 0.149403-0.73678 0.149403l-62.496379 0.146333c-1.425466-0.195451-2.90005-0.295735-4.373611-0.295735-19.677155 0-35.621289 16.141632-35.621289 36.114522L86.622358 888.550075c0 19.949354 15.96767 35.597753 35.670407 35.597753 1.916653 0 3.808746 0.292666 5.649674 0l61.022819 0.022513c0.099261 0 0.148379 0.048095 0.24764 0.048095 0.097214 0 0.146333-0.048095 0.24457-0.048095l0.73678 0 0-0.148379c13.413498-0.540306 24.174586-11.422144 24.174586-24.960485 0-13.55983-10.760065-24.441669-24.174586-24.981974l0-0.393973-50.949392 0 1.450025-402.275993L190.193225 471.409536z"
                                fill="#d81e06" p-id="3229"></path>
                            <path
                                d="M926.52241 433.948343c-19.283182-31.445176-47.339168-44.172035-81.289398-45.546336-1.77032-0.246617-3.536546-0.39295-5.380544-0.39295l-205.447139-0.688685c13.462616-39.059598 22.698978-85.58933 22.698978-129.317251 0-28.349675-3.193739-55.962569-9.041934-82.542948l-0.490164 0.049119c-10.638291-46.578852-51.736315-81.31498-100.966553-81.31498-57.264215 0-95.466282 48.15065-95.466282 106.126063 0 3.241834-0.294712 6.387477 0 9.532097-2.996241 108.386546-91.240027 195.548698-196.23636 207.513194l0 54.881958-0.785899 222.227314 0 229.744521 10.709923 0 500.025271 0.222057 8.746198-0.243547c19.35686 0.049119 30.239721-4.817726 47.803749-16.116049 16.682961-10.761088 29.236881-25.50079 37.490869-42.156122 2.260483-3.341095 4.028757-7.075139 5.106298-11.20111l77.018118-344.324116c1.056052-4.053316 1.348718-8.181333 1.056052-12.160971C943.643346 476.446249 938.781618 453.944769 926.52241 433.948343zM893.82573 486.837924l-82.983993 367.783411-0.099261-0.049119c-2.555196 6.141884-6.879688 11.596106-12.872169 15.427364-4.177136 2.727111-8.773827 4.351098-13.414521 4.351098l-55.772522-0.073678c-4.473551 0-8.232497-2.850927-9.582237-6.879688l-68.514417-216.035447c-0.294712-0.859577-0.908286-1.547239-1.694273-1.892404-0.785899-0.36839-1.695296-0.344855-2.455933 0.098238l-184.459341 98.403759c-3.144621 1.769296-6.977921 1.349741-9.680472-0.98238-2.678762-2.333857-3.807722-6.019087-2.850927-9.508561l56.802967-210.850198c0.221034-0.810459 0.171916-1.670737-0.147356-2.455933-0.318247-0.786922-0.957403-1.399882-1.76725-1.72018l-156.417244-62.102409c-4.05434-1.621619-6.3885-5.946433-5.430856-10.193436 0.957403-4.250074 4.889356-7.247048 9.215401-7.076162l128.522914 5.35699c0.884135 0.049119 1.744026-0.245593 2.383279-0.835017 0.63823-0.565889 0.981961-1.399882 0.981961-2.260483l-1.940189-132.896706c-0.122797-4.423411 2.875486-8.207938 7.150865-9.018398 4.29919-0.835017 8.355288 1.866509 9.633401 6.068209l70.160655 212.86826c0.270153 0.810459 0.884135 1.449002 1.669714 1.744738 0.785899 0.294712 1.669714 0.196475 2.382255-0.271176l143.911364-90.171228c3.68492-2.285042 8.380869-1.25253 10.930449 2.235924 2.53166 3.48947 2.260483 8.330729-0.589419 11.520888l-117.414984 135.254823c-0.564866 0.639253-0.785899 1.52268-0.613978 2.358717 0.171916 0.83604 0.73678 1.547239 1.523704 1.916653l128.694831 59.81804c4.005221 1.866509 6.216584 6.264679 5.184072 10.513222l-1.916653 7.863953 0.073678-0.294712z"
                                fill="#d81e06" p-id="3230"></path>
                        </svg>
                        <span>{{ hospitalStore.hospitalInfo.hospital?.param.hostypeString }}</span>
                    </div>
                </div>
                <!-- 展示医院的logo与路线 -->
                <div class="logo">
                    <div class="left">
                        <el-image style="width: 80px; height: 80px" :src="hospitalStore.hospitalInfo.hospital?.logoData" fit="fill">
                            <template #error>
                                <div class="image-slot">
                                    <el-icon><Picture /></el-icon>
                                </div>
                            </template>
                        </el-image>
                    </div>
                    <div class="right">
                        <div class="address">
                            <svg t="1768818386457" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="5348" width="16" height="16">
                                <path
                                    d="M874.048 533.333C863.424 716.63 716.629 863.424 533.333 874.048v43.285a21.333 21.333 0 0 1-42.666 0v-43.285C307.37 863.424 160.576 716.629 149.952 533.333h-43.285a21.333 21.333 0 0 1 0-42.666h43.285c10.624-183.296 157.419-330.091 340.715-340.715v-43.285a21.333 21.333 0 0 1 42.666 0v43.285c183.296 10.624 330.091 157.419 340.715 340.715h42.816a21.333 21.333 0 1 1 0 42.666h-42.837z m-42.752 0H703.509a21.333 21.333 0 0 1 0-42.666h127.787c-10.517-159.744-138.24-287.446-297.963-297.963V320a21.333 21.333 0 0 1-42.666 0V192.704c-159.744 10.517-287.446 138.24-297.963 297.963H320a21.333 21.333 0 0 1 0 42.666H192.704c10.517 159.744 138.24 287.446 297.963 297.963V704a21.333 21.333 0 0 1 42.666 0v127.296c159.744-10.517 287.446-138.24 297.963-297.963zM512 554.667a42.667 42.667 0 1 1 0-85.334 42.667 42.667 0 0 1 0 85.334z"
                                    p-id="5349"></path>
                            </svg>
                            <span>具体位置：{{ hospitalStore.hospitalInfo.hospital?.param.fullAddress }}</span>
                        </div>
                        <!-- 具体路线 -->
                        <div class="route">
                            规划路线：{{ hospitalStore.hospitalInfo.hospital?.route }}
                        </div>
                    </div>
                </div>
                <!-- 医院的介绍 -->
                <div class="footer">
                    <h1>医院的介绍</h1>
                    <p>{{ hospitalStore.hospitalInfo.hospital?.intro }}</p>
                </div>
            </template>
        </el-skeleton>
    </div>
</template>

<script setup lang="ts">
//获取医院详情数据进行展示
import useDetailStore from '@/store/modules/hospitalDetail';
import { onMounted, watch, ref } from 'vue';
import { useRoute } from 'vue-router';
import { Picture } from '@element-plus/icons-vue';
let hospitalStore = useDetailStore();
const route = useRoute();
const loading = ref(false);

// 进入详情页时，确保仓库有数据；若缺失或不匹配则根据路由参数拉取
onMounted(async () => {
    const code = route.query.hoscode as string;
    // 如果没有数据，或者当前存储的医院编码与路由参数不一致，则重新获取
    if (code && hospitalStore.hospitalInfo?.hospital?.hoscode != code) {
        loading.value = true;
        await hospitalStore.getHospital(code);
        loading.value = false;
    }
});
// 监听路由参数变化，动态拉取
watch(() => route.query.hoscode, async (val) => {
    const code = val as string;
    if (code) {
        loading.value = true;
        await hospitalStore.getHospital(code);
        loading.value = false;
    }
});
</script>

<style scoped lang="scss">
.detail {
    .top {
        display: flex;
        align-items: center;

        .name {
            font-size: 30px;
            font-weight: 900;
        }

        .level {
            color: #7f7f7f;
            margin-left: 10px;

            span {
                margin-left: 5px;
            }
        }
    }

    .logo {
        display: flex;
        margin: 10px 0px;

        .left {
            img {
                width: 80px;
                height: 80px;
            }
        }

        .right {
            color: #7f7f7f;
            margin-left: 10px;

            div {
                margin: 10px 0px;
            }
        }
    }

    .footer {
        color: #7f7f7f;

        p {
            margin-top: 10px;
            line-height: 30px;
        }
    }
}
</style>